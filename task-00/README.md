# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂ –∏–∑ CSV —Å –∑–∞–ø–∏—Å—å—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ñ–∞–π–ª

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ (–∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ)

–ï—Å—Ç—å _CSV_-—Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö.

–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å _Python_-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- —Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV-—Ñ–∞–π–ª–∞;
- —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–µ–≥–∏–æ–Ω—É;
- —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏;
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π CSV-—Ñ–∞–π–ª.

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

üìÑ sales_input.csv
```
date,region,product,revenue
2024-01-01,EU,A,1200
2024-01-02,US,A,900
2024-01-03,EU,B,1500
2024-01-04,EU,A,700
2024-01-05,US,B,1100
```

## –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

üìÑ sales_summary.csv
```
region,sales_count,total_revenue,average_revenue
EU,3,3400,1133.33
```

(–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫, –º—ã —ç—Ç–æ –æ–±—Å—É–¥–∏–º –ø–æ–∑–∂–µ)

## –ü–æ–ª–Ω—ã–π, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π –ø—Ä–∏–º–µ—Ä (production-style)

```
import pandas as pd
from pathlib import Path


def load_sales_data(input_path: Path) -> pd.DataFrame:
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∏–∑ CSV-—Ñ–∞–π–ª–∞.
    """
    return pd.read_csv(input_path)


def analyze_sales_by_region(
    df: pd.DataFrame,
    region: str,
) -> pd.DataFrame:
    """
    –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω—É –∏
    –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
    """
    filtered_df = df.loc[df["region"] == region]

    result = pd.DataFrame(
        {
            "region": [region],
            "sales_count": [len(filtered_df)],
            "total_revenue": [filtered_df["revenue"].sum()],
            "average_revenue": [filtered_df["revenue"].mean()],
        }
    )

    return result


def save_summary(df: pd.DataFrame, output_path: Path) -> None:
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤ CSV-—Ñ–∞–π–ª.
    """
    df.to_csv(output_path, index=False)


def main() -> None:
    base_dir = Path(__file__).resolve().parent

    input_file = base_dir / "sales_input.csv"
    output_file = base_dir / "sales_summary.csv"

    sales_df = load_sales_data(input_file)

    summary_df = analyze_sales_by_region(
        sales_df,
        region="EU",
    )

    save_summary(summary_df, output_file)

    print("Analysis completed.")
    print(f"Result saved to: {output_file.resolve()}")


if __name__ == "__main__":
    main()
```

## –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–≤–∞–∂–Ω–æ!)

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ:
- `load_sales_data()` ‚Äî **—Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞**;
- `analyze_sales_by_region()` ‚Äî **—Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**;
- `save_summary()` ‚Äî **—Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**;
- `main()` ‚Äî **–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è**.

–≠—Ç–æ:
- –æ–±–ª–µ–≥—á–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ;
- –ø–æ–≤—ã—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å;
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–µ-—Ñ–∞–∫—Ç–æ –¥–ª—è production-–∫–æ–¥–∞.

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `df.loc[...]`

`filtered_df = df.loc[df["region"] == region]`


–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º ‚Äú–ø–æ —à–∞–≥–∞–º‚Äù:

1. `df["region"] == region`

   ‚Üí –±—É–ª–µ–≤ –º–∞—Å—Å–∏–≤:

   `True / False` –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏


2. `df.loc[...]`

   ‚Üí –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ `True`.

**–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π _Python_-–∞–Ω–∞–ª–æ–≥:**
```
rows = []
for _, row in df.iterrows():
    if row["region"] == region:
        rows.append(row)
```

–í `pandas` —Ç–∞–∫–æ–π –∫–æ–¥:
- –º–µ–¥–ª–µ–Ω–Ω–µ–µ;
- –º–µ–Ω–µ–µ —á–∏—Ç–∞–µ–º;
- —Å—á–∏—Ç–∞–µ—Ç—Å—è –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω–æ–º.

### –ü–æ—á–µ–º—É –Ω–µ—Ç —Ü–∏–∫–ª–æ–≤

`filtered_df["revenue"].sum()`

–≠—Ç–æ:
- –Ω–µ —Ü–∏–∫–ª –≤ _Python_;
- –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞–¥ `NumPy`-–º–∞—Å—Å–∏–≤–æ–º;
- –±—ã—Å—Ç—Ä—ã–π _C_-–∫–æ–¥.

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö **—Ü–∏–∫–ª—ã –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è**.

### –ü–æ—á–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî `DataFrame`

–î–∞–∂–µ –µ—Å–ª–∏ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
- —Ñ–æ—Ä–º–∞—Ç —Å—Ç–∞–±–∏–ª–µ–Ω;
- —É–¥–æ–±–Ω–æ:
  - –ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª,
  - —Ä–∞—Å—à–∏—Ä—è—Ç—å,
  - –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.