# –ó–∞–¥–∞—á–∞ ‚Ññ2
# –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º (`GROUP BY`)

## –¶–µ–ª—å –∑–∞–¥–∞—á–∏

–ù–∞—É—á–∏—Ç—å—Å—è:
- –≤—ã–ø–æ–ª–Ω—è—Ç—å **–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö** –≤ pandas;
- —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ **–¥–ª—è –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π** –∑–Ω–∞—á–µ–Ω–∏–π;
- –ø–æ–ª—É—á–∞—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–≠—Ç–æ **–∫–ª—é—á–µ–≤–æ–π –Ω–∞–≤—ã–∫** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –±–µ–∑ `groupby` `pandas` —Ç–µ—Ä—è–µ—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Å–≤–æ–µ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏.

## –û–ø–∏—Å–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π _CSV_-—Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ–¥–∞–∂–∞—Ö.

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –æ–¥–Ω–∞ –ø—Ä–æ–¥–∞–∂–∞.

–ü–æ–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

| –ü–æ–ª–µ      | –¢–∏–ø            | –û–ø–∏—Å–∞–Ω–∏–µ      |
|-----------|----------------|---------------|
| `date`    | `string (ISO)` | –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏  |
| `region`  | `string`       | –†–µ–≥–∏–æ–Ω        |
| `product` | `string`       | –ö–æ–¥ –ø—Ä–æ–¥—É–∫—Ç–∞  |
| `revenue` | `integer`      | –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂–∏ |

## –§–æ—Ä–º–∞—Ç –∏ –ø—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

üìÑ data/input/sales_input.csv
```
date,region,product,revenue
2024-01-01,EU,A,1200
2024-01-02,US,A,900
2024-01-03,EU,B,1500
2024-01-04,EU,A,700
2024-01-05,US,B,1100
2024-01-06,EU,B,800
2024-01-07,US,A,600
2024-01-08,EU,A,400
```

## –¢—Ä–µ–±—É–µ–º–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞:
1. —Å—á–∏—Ç–∞—Ç—å –≤—Ö–æ–¥–Ω–æ–π _CSV_-—Ñ–∞–π–ª;
2. –≤—ã–ø–æ–ª–Ω–∏—Ç—å **–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö** –ø–æ:
   - `region`
   - `product`
3. –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å:
   - `sales_count` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂;
   - `total_revenue` ‚Äî —Å—É–º–º–∞—Ä–Ω—É—é –≤—ã—Ä—É—á–∫—É;
   - `average_revenue` ‚Äî —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É;
4. —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤ _CSV_-—Ñ–∞–π–ª.

## –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

üìÑ data/result/sales_summary.csv

–í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å **–æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –Ω–∞ –∫–∞–∂–¥—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é** `region` + `product`.

–ü–æ–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

| –ü–æ–ª–µ            | –û–ø–∏—Å–∞–Ω–∏–µ          |
|-----------------|-------------------|
| region          | –†–µ–≥–∏–æ–Ω            |
| product         | –ü—Ä–æ–¥—É–∫—Ç           |
| sales_count     | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ |
| total_revenue   | –°—É–º–º–∞—Ä–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ |
| average_revenue | –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞   |

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

–î–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤—ã—à–µ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–º:
```
region,product,sales_count,total_revenue,average_revenue
EU,A,3,2300,766.67
EU,B,2,2300,1150.00
US,A,2,1500,750.00
US,B,1,1100,1100.00
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
- **–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ ‚Äî –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π**;
- **–ø–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω (–µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã)**.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—à–µ–Ω–∏—é

–†–µ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ:
- –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ –≤ –≤–∏–¥–µ _Python_-—Å–∫—Ä–∏–ø—Ç–∞;
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pandas`;
- —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ **–∏–∑ —Ñ–∞–π–ª–∞**;
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–≤ —Ñ–∞–π–ª**;
- –∏–º–µ—Ç—å:
  - `main()`,
  - `if __name__ == "__main__":`;
- –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–≤–Ω—ã–µ _Python_-—Ü–∏–∫–ª—ã –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–π;
- –±—ã—Ç—å —á–∏—Ç–∞–µ–º—ã–º –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º.

8. –ü–æ–¥—Å–∫–∞–∑–∫–∞ (–±–µ–∑ –∫–æ–¥–∞)

–í `pandas` –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è:
- groupby(...)
- agg(...)
- reset_index()

–ú—ã **–ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º —ç—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –ø—Ä–∏—à–ª—ë—Ç–µ —Å–≤–æ—ë —Ä–µ—à–µ–Ω–∏–µ.