# –ó–∞–¥–∞—á–∞ A1 ‚Äî Advanced pandas (Pivot + Reshaping + Derived Metrics)

–£—Ä–æ–≤–µ–Ω—å: –≤—ã—à–µ [–ø—Ä–µ–¥—ã–¥—É—â–µ–π](../task-03/README.md)

–§–æ–∫—É—Å:
- pivot_table
- multi-index —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
- –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ–≤–µ—Ä—Ö pivot

–≠—Ç–æ –æ—á–µ–Ω—å —Ç–∏–ø–∏—á–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.

## –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏

–ö–æ–º–ø–∞–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤.
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. –°—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ _CSV_
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ—á–∏—Å—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö:
   - —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ `quantity <= 0`
   - —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ `unit_price < 0`
3. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å:
   - `revenue = quantity * unit_price`
4. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å _pivot_-—Ç–∞–±–ª–∏—Ü—É:
   - –°—Ç—Ä–æ–∫–∏:
     ```
     region
     ```
   - –ö–æ–ª–æ–Ω–∫–∏:
     ```
     category
     ```
   - –ó–Ω–∞—á–µ–Ω–∏—è:
     ```
     sum(revenue)
     ```
5. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –Ω—É–ª—è–º–∏

6. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É:
   - `TOTAL` ‚Äî —Å—É–º–º–∞ revenue –ø–æ —Å—Ç—Ä–æ–∫–µ
7. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
   - `ALL` ‚Äî —Å—É–º–º–∞ –ø–æ –≤—Å–µ–º —Ä–µ–≥–∏–æ–Ω–∞–º
8. –û–∫—Ä—É–≥–ª–∏—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ 2 –∑–Ω–∞–∫–æ–≤
9. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ CSV

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

–°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω:
- —á–∏—Ç–∞—Ç—å –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
- –ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
- –±—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
- –∏–º–µ—Ç—å `main()`
- –∏–º–µ—Ç—å –∑–∞—â–∏—Ç—É –≤—ã–∑–æ–≤–∞
- –∏–º–µ—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

(—Ä–æ–≤–Ω–æ –∫–∞–∫ –≤ –ø—Ä–æ—à–ª—ã—Ö –∑–∞–¥–∞—á–∞—Ö)

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

üì• `sales.csv`
```
order_id,region,category,quantity,unit_price
1,EU,Hardware,2,100
2,EU,Software,1,200
3,US,Hardware,3,50
4,US,Software,2,150
5,APAC,Hardware,1,120
6,APAC,Software,2,130
7,EU,Hardware,0,100
8,US,Hardware,2,-10
9,EU,Services,1,180
10,US,Services,2,110
```

## Golden Output

üì§ 
```
region,Hardware,Services,Software,TOTAL
APAC,120,0,260,380
EU,200,180,200,580
US,150,220,300,670
ALL,470,400,760,1630
```

## –ü–æ–¥—Å–∫–∞–∑–∫–∏ (–Ω–µ —Ä–µ—à–µ–Ω–∏—è)

### `pivot_table`

–ü–æ—Å–º–æ—Ç—Ä–∏:

`pd.pivot_table()`

–≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑–∞–¥–∞—á–∏.

### –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤

`fill_value=0`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `TOTAL` –∫–æ–ª–æ–Ω–∫–∏

–í–µ–∫—Ç–æ—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è:

`df.sum(axis=1)`

(—ç—Ç–æ —Å—É–º–º–∞ –ø–æ —Å—Ç—Ä–æ–∫–µ)

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ `ALL`

–ü–æ–¥—É–º–∞–π –ø—Ä–æ:

`pd.concat()`

### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–∞—è –∑–∞–¥–∞—á–∞

–¢—ã –æ—Å–≤–æ–∏—à—å:
- _reshaping_ –¥–∞–Ω–Ω—ã—Ö
- _pivot_ –º—ã—à–ª–µ–Ω–∏–µ
- _multi-dimensional aggregation_
- –æ—Å–Ω–æ–≤—É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ _BI_-–∞–Ω–∞–ª–∏—Ç–∏–∫ _pipeline_

–≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ.